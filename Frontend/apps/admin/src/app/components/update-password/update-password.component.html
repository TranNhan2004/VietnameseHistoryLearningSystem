<h3 class="text-2xl font-bold mb-4 text-my-blue">Đổi mật khẩu</h3>
<form [formGroup]="passwordForm" class="space-y-4">
  <label for="oldPassword" class="flex items-center space-x-3 text-gray-700">
    <span class="min-w-[140px]">Mật khẩu cũ:</span>
    <div class="min-w-[500px]">
      <lib-password-input
        id="oldPassword"
        formControlName="oldPassword"
        containerClass="flex-1"
        [inputNgClass]="{
         'border rounded-lg p-2 focus:outline-none focus:ring focus:border-myblue w-full': true,
         'bg-gray-300 cursor-not-allowed caret-transparent': !editMode,
        }"
        [readonly]="!editMode"
        [disabled]="!editMode"
      ></lib-password-input>

      @if (editMode && passwordFH.isInvalid('oldPassword')) {
        @if (passwordFH.hasError('oldPassword', 'required')) {
          <p class="error max-w-[500px]">{{ userMessage.OLD_PASSWORD__REQUIRED }}</p>
        } @else if (passwordFH.hasError('oldPassword', 'pattern') ||
        passwordFH.hasError('oldPassword', 'minlength') ||
        passwordFH.hasError('oldPassword', 'maxlength')) {
          <p class="error max-w-[500px]">{{ userMessage.OLD_PASSWORD__INVALID }}</p>
        }
      }

    </div>
  </label>

  <label class="flex items-center space-x-3 text-gray-700">
    <span class="min-w-[140px]">Mật khẩu mới:</span>
    <div class="min-w-[500px]">
      <input
        type="password"
        formControlName="newPassword"
        [ngClass]="{
         'flex-1 border rounded-lg p-2 focus:outline-none focus:ring focus:border-myblue w-full': true,
         'cursor-not-allowed caret-transparent bg-gray-300': !editMode
        }"
        [readonly]="!editMode"
        [disabled]="!editMode"
      />

      @if (editMode && passwordFH.isInvalid('newPassword')) {
        @if (passwordFH.hasError('newPassword', 'required')) {
          <p class="error max-w-[500px]">{{ userMessage.NEW_PASSWORD__REQUIRED }}</p>
        } @else if (passwordFH.hasError('newPassword', 'pattern') ||
        passwordFH.hasError('newPassword', 'minlength') ||
        passwordFH.hasError('newPassword', 'maxlength')) {
          <p class="error max-w-[500px]">{{ userMessage.NEW_PASSWORD__INVALID }}</p>
        }
      }
    </div>
  </label>

  <label class="flex items-center space-x-3 text-gray-700">
    <span class="min-w-[140px]">Xác nhận mật khẩu:</span>
    <div class="min-w-[500px]">
      <input
        type="password"
        formControlName="confirmNewPassword"
        [ngClass]="{
         'flex-1 border rounded-lg p-2 focus:outline-none focus:ring focus:border-myblue w-full': true,
         'cursor-not-allowed caret-transparent bg-gray-300': !editMode
        }"
        [readonly]="!editMode"
        [disabled]="!editMode"
      />

      @if (editMode && passwordFH.isInvalid('confirmNewPassword')) {
        @if (passwordFH.hasError('confirmNewPassword', 'required')) {
          <p class="error max-w-[500px]">{{ userMessage.CONFIRM_NEW_PASSWORD__REQUIRED }}</p>
        } @else if (passwordFH.hasError('confirmNewPassword', 'pattern') ||
        passwordFH.hasError('confirmNewPassword', 'minlength') ||
        passwordFH.hasError('confirmNewPassword', 'maxlength')) {
          <p class="error max-w-[500px]">{{ userMessage.CONFIRM_NEW_PASSWORD__INVALID }}</p>
        }
      }
    </div>
  </label>

  @if (editMode) {
    <div class="flex space-x-2 mt-4">
      <lib-action-button
        name="save"
        mainTitle="Lưu"
        title=""
        [disabled]="passwordForm.invalid"
        (btnClick)="savePassword()"
      ></lib-action-button>

      <lib-action-button
        name="cancel"
        mainTitle="Hủy"
        title=""
        (btnClick)="cancelEditPassword()"
      ></lib-action-button>
    </div>
  }
</form>
