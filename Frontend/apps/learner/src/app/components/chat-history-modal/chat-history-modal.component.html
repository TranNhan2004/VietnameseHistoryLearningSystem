@if (isOpen) {
  <div
    class="fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-40"
  >
    <div
      class="bg-white w-[90%] h-[80%] overflow-y-auto rounded-2xl border border-gray-300 shadow-lg p-6"
    >
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold text-center flex-1">Lịch sử chat</h2>

        <button
          type="button"
          (click)="close()"
          class="text-gray-500 hover:text-gray-800 text-xl font-bold ml-4"
          title="Đóng"
        >
          <ng-icon name="matCloseRound" size="30"></ng-icon>
        </button>
      </div>


      @for (group of groupedHistories; track group.createdAt) {
        <div class="mb-2 mt-6">
          <div class="text-sm text-gray-500 mb-1">
            {{ group.createdAt | date: 'dd/MM/yyyy' }}
          </div>
          <div class="h-px bg-gray-300"></div>
        </div>

        @for (item of group.histories; track item.id) {
          <div
            class="py-2 px-3 rounded cursor-pointer flex justify-between items-center gap-2"
            [ngClass]="{
              'bg-blue-100 hover:bg-blue-200': item.id === selectedChatHistoryId,
              'hover:bg-gray-100': item.id !== selectedChatHistoryId
            }"
            role="button"
            tabindex="0"
            (click)="selectHistory.emit(item.id)"
            (keydown.enter)="selectHistory.emit(item.id)"
            (keydown.space)="selectHistory.emit(item.id)"
          >
            <span class="text-base font-medium text-gray-800 truncate">
              {{ item.title }}
            </span>

            <lib-action-button
              [name]="ActionButtonName.Delete"
              title=""
              mainTitle=""
              (btnClick)="deleteHistory.emit(item.id)"
            ></lib-action-button>
          </div>
        }
      }
    </div>
  </div>
}
